{% extends "base.html" %}

{% block content %}
<h2>Scan Results</h2>

{% for url, result in results.items() %}
<h3>Results for {{ url }}</h3>

{% if result.headers %}
<h4>Missing Security Headers</h4>
<ul>
    {% for header in result.headers.get('missing_headers', []) %}
    <li>{{ header }} is missing</li>
    {% else %}
    <li>No missing headers found.</li>
    {% endfor %}
</ul>
{% endif %}

{% if result.xss %}
<h4>Cross-Site Scripting (XSS) Results</h4>
<ul>
    {% for entry in result.xss %}
    <li>{{ entry.url }} - {% if entry.vulnerable %}Vulnerable{% else %}Not Vulnerable{% endif %}</li>
    {% endfor %}
</ul>
{% endif %}

{% if result.sql_injection %}
<h4>SQL Injection Results</h4>
<ul>
    {% for entry in result.sql_injection %}
    <li>{{ entry.url }} - {% if entry.vulnerable %}Vulnerable{% else %}Not Vulnerable{% endif %}</li>
    {% endfor %}
</ul>
{% endif %}
{% endfor %}

<a href="{{ url_for('download_report') }}" class="btn btn-primary">Download PDF Report</a>
{% endblock %}
