{% extends "base.html" %}

{% block content %}
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="alert-container">
      {% for category, message in messages %}
        <div class="alert alert-{{ category }}">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

<form method="POST" action="{{ url_for('scan') }}">
    <label for="url">Enter URL:</label>
    <input type="text" id="url" name="url" required>

    <fieldset>
        <legend>Select Scanning Method:</legend>
        <label>
            <input type="radio" name="scan_method" value="single">
            Single URL
        </label>
        <label>
            <input type="radio" name="scan_method" value="crawl">
            Web Crawling
        </label>
    </fieldset>

    <fieldset>
        <legend>Select Scan Type(s):</legend>
        <label>
            <input type="checkbox" id="all_scans" name="scan_type" value="all">
            All Scans
        </label>
        <label>
            <input type="checkbox" name="scan_type" value="headers">
            Missing Headers
        </label>
        <label>
            <input type="checkbox" name="scan_type" value="xss">
            Cross-Site Scripting (XSS)
        </label>
        <label>
            <input type="checkbox" name="scan_type" value="sql_injection">
            SQL Injection
        </label>
        

    </fieldset>

    <button type="submit">Start Scan</button>

</form>
<script>
    document.getElementById('all_scans').addEventListener('change', function() {
        // Get the state of the "All Scans" checkbox
        var isChecked = this.checked;

        // Select all checkboxes with name "scan_type" except for the "All Scans" checkbox
        var checkboxes = document.querySelectorAll('input[name="scan_type"]:not(#all_scans)');

        // Set the checked state of all the checkboxes
        checkboxes.forEach(function(checkbox) {
            checkbox.checked = isChecked;
        });
    });
</script>

{% endblock %}
