import requests

# List of common security headers to check
REQUIRED_HEADERS = [
    'Content-Security-Policy',
    'Strict-Transport-Security',
    'X-Content-Type-Options',
    'X-Frame-Options',
    'X-XSS-Protection',
    'Referrer-Policy'
]

def check_missing_headers(url):
    try:
        response = requests.head(url, timeout=10)  # Send a HEAD request to minimize data transfer
        missing_headers = []

        for header in REQUIRED_HEADERS:
            if header not in response.headers:
                missing_headers.append(header)

        return {
            'url': url,
            'missing_headers': missing_headers,
            'status': 'completed'
        }
    except requests.RequestException as e:
        return {
            'url': url,
            'error': str(e),
            'status': 'failed'
        }
